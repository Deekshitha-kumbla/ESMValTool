# ESMValTool
# recipe_lauer13jclim.yml
---
documentation:
  description: |
    Diagnostics of clouds and hydrological cycle reproducing selected figures
    from Lauer and Hamilton (2013).

  authors:
    - lauer_axel

  maintainer:
    - lauer_axel

  references:
    - lauer13jclim

  projects:
    - esmval
    - embrace

extract_tropics: &extr_trop
  extract_region: 
    start_longitude: 0
    end_longitude: 360
    start_latitude: -30
    end_latitude: 30

extract_itcz: &extr_itcz
  extract_region: 
    start_longitude: 136
    end_longitude: 275
    start_latitude: 0
    end_latitude: 12
 
extract_southasianmonsoon: &extr_samonsoon
  extract_region:
    start_longitude: 65
    end_longitude: 95
    start_latitude: 5
    end_latitude: 30

extract_europe: &extr_europe
  extract_region: 
    end_latitude: 53
    end_longitude: 20
    start_latitude: 42
    start_longitude: 0


datasets:
  - {dataset: ERA-Interim, project: OBS6, type: reanaly, version: '1', 
     tier: 3, start_year: 1983, end_year: 2016}       
  - {dataset: PERSIANN-CDR, project: OBS, type: reanaly, version: v01r01,
     tier: 2, start_year: 1983, end_year: 2016}  
  - {dataset: JRA-55, project: ana4mips, type: reanalysis, mip: Amon,
     tier: 1, start_year: 1983, end_year: 2016}  
  - {dataset: GPCP-SG, project: obs4mips, level: L3, version: v2.3, 
     tier: 1, start_year: 1983, end_year: 2016}  
  - {dataset: GPCC, project: OBS, type: reanaly, version: v2018_25, 
     tier: 2, start_year: 1983, end_year: 2016}  
  - {dataset: ERA5, project: OBS6, type: reanaly, version: v1,
     tier: 3, start_year: 1983, end_year: 2016}  
  - {dataset: ERA5-Land, project: OBS6, type: reanaly, version: v1,
     tier: 3, start_year: 1983, end_year: 2016}  
  # - {dataset: TRMM-L3, project: obs4mips, level: v7, version: 7A,
     # tier: 1, start_year: 1983, end_year: 2016}
  - {dataset: MERRA2, project: OBS6, type: reanaly, version: 5.12.4,
     tier: 3, start_year: 1983, end_year: 2016}
  # - {dataset: E-OBS, project: OBS, type: ground, version: v21.0e-0.1,
     # tier: 3, start_year: 1983, end_year: 2016}
  - {dataset: WFDE5, project: OBS6, type: ground, version: v1.1-CRU+GPCC,
     tier: 3, start_year: 1983, end_year: 2016}


preprocessors:
  clim:
    regrid:
      target_grid: 2.5x2.5
      scheme: linear
    mask_fillvalues:
      threshold_fraction: 0.80
    multi_model_statistics:
      span: overlap
      statistics: [mean]
      exclude: [reference_dataset]
    # <<: *extr_trop
    mask_landsea:
      mask_out: sea


diagnostics:

  # ==========================================================================
  # Lauer and Hamilton (2013) - Figure 1
  # Geographical distribution of multi-year annual/seasonal means (panel plot)
  # ==========================================================================


  clouds_fig1_pr:
    description: climatological annual means
    themes:
      - clouds
    realms:
      - atmos
    variables:
      pr:
        preprocessor: clim
        reference_dataset: GPCP-SG
        mip: Amon
    #additional_datasets:
    #  - {dataset: GPCP-SG, project: obs4mips, level: L3, version: v2.2,
    #     start_year: 1986, end_year: 2005, tier: 1}
    scripts:
      clim:
        script: clouds/clouds.ncl
        # projection
        # ----------
        # map projection, e.g., Mollweide, Mercator, CylindricalEquidistant
        projection: CylindricalEquidistant
        # timemean
        # --------
        # - annualclim: 1 plot (annual mean)
        # - seasonalclim: 4 plots (DJF, MAM, JJA, SON)
        timemean: annualclim
        showdiff: true
        #region: [42., 53., 0., 20.]     # Europe
        #region: [0., 12., 136., 275.]    # ITCZ
        #region: [5., 30., 65., 95.]    # SA Monsoon
        region: [-30., 30., 0., 360.]    # Tropics

  # # ==========================================================================
  # # Lauer and Hamilton (2013) - Figure 3
  # # Taylor plots of multi-year mean quantities
  # # ==========================================================================

  # clouds_fig3_pr:
    # description: climatological annual means
    # themes:
      # - clouds
    # realms:
      # - atmos
    # variables:
      # pr:
        # preprocessor: clim
        # reference_dataset: GPCP-SG
        # mip: Amon
    # #additional_datasets:
    # #  - {dataset: GPCP-SG, project: obs4mips, level: L3, version: v2.2,
    # #     start_year: 1986, end_year: 2005, tier: 1}
    # scripts:
      # clim:
        # script: clouds/clouds_taylor.ncl
        # # emrabcelegend
        # # -------------
        # # - true:  1) save legend to separate file
        # #          2) plot alternative reference data set (if available) as a
        # #             black or red star and use "altern. ref. dataset" as label
        # # - false: 1) plot legend into taylor plot (same file)
        # #          2) plot alternative reference data set (if available) using
        # #             model symbols and use name of observations as label
        # embracelegend: false
        # # estimate_obs_uncertainty
        # # ------------------------
        # # - true:  estimate observational uncertainties from mean values
        # #          (assuming fractions of obs. RMSE from documentation of the
        # #          obs data); only available for "CERES-EBAF", "MODIS",
        # #          "MODIS-L3"
        # # - false: do not estimate obs. uncertainties from mean values
        # estimate_obs_uncertainty: false
        # # mask_ts_sea_ice
        # # ---------------
        # # - true:  mask T < 272 K as sea ice (only for variable "ts")
        # # - false: no additional grid cells masked for variable "ts"
        # mask_ts_sea_ice: false
        # # styleset
        # # --------
        # # styleset (line styles + symbols) used for plotting
        # # ("CMIP5", "DEFAULT")
        # styleset: CMIP5
        # # timemean
        # # --------
        # # - annualclim: 1 plot (annual mean)
        # # - seasonalclim: 4 plots (DJF, MAM, JJA, SON)
        # timemean: annualclim
        # # valid_fraction
        # # --------------
        # # used for creating sea ice mask (mask_ts_sea_ice = true): fraction of
        # # valid time steps required to mask grid cell as valid data
        # valid_fraction: 0.5

  # # ==========================================================================
  # # Lauer and Hamilton (2013) - Equation 2, part of Figure 8
  # # Interannual variability: relative temporal standard deviation calculated
  # # from monthly mean anomalies after subtracting the climatological mean
  # # seasonal cycle
  # # ==========================================================================


  # clouds_fig8_pr:
    # description: interannual variability
    # themes:
      # - clouds
    # realms:
      # - atmos
    # variables:
      # pr:
        # preprocessor: clim
        # reference_dataset: GPCP-SG
        # mip: Amon
    # #additional_datasets:
    # #  - {dataset: GPCP-SG, project: obs4mips, level: L3, version: v2.2,
    # #     start_year: 1986, end_year: 2005, tier: 1}
    # scripts:
      # clim:
      # clim: &intera_settings
        # script: clouds/clouds_interannual.ncl
        # # colormap
        # # --------
        # # colors for scale bar (e.g., WhiteBlueGreenYellowRed, rainbow)
        # colormap: WhiteBlueGreenYellowRed
        # # extrafiles
        # # ----------
        # # write plots for individual models to separate files (true, false)
        # extrafiles: false
        # # projection
        # # ----------
        # # map projection, e.g., Mollweide, Mercator, CylindricalEquidistant
        # projection: CylindricalEquidistant
        # # timemean
        # # --------
        # # - annualclim: 1 plot (annual mean)
        # # - seasonalclim: 4 plots (DJF, MAM, JJA, SON)
        # timemean: annualclim
