# ESMValTool
# recipe_gwt_time_series.yml
---
documentation:
  description: |
    Recipe to calcualte changes in behaviour at specific years for the UKESM
    Land surface Global warming thresholds.

    The years were calculated using recipe_gwt_temp.yml

  authors:
    - demora_lee

  maintainer:
    - demora_lee

  references:
    - demora2018gmd

  projects:
    - ukesm

preprocessors:
  prep_timeseries_2d_sea:
    custom_order: true
    area_statistics:
      operator: mean
      fx_variables: [{short_name: areacello, mip: Ofx, exp: piControl, ensemble: r1i1p1f2, grid: gn, activity: CMIP}]
    annual_statistics:
      operator: mean

  prep_total_sea:
    custom_order: true
    mask_landsea:
      mask_out: land  # if land (sea), will mask land (sea and oceans) out
#    area_statistics:
#      operator: sum


  prep_timeseries_2d_land:
    custom_order: true
    annual_statistics:
      operator: mean
    mask_landsea:
      mask_out: sea  # if land (sea), will mask land (sea and oceans) out
    area_statistics:
      operator: mean
      fx_variables: [{short_name: areacella, mip: fx, exp: piControl, ensemble: r1i1p1f2, grid: gn, activity: CMIP}]

  prep_total_land:
    custom_order: true
    mask_landsea:
      mask_out: sea  # if land (sea), will mask land (sea and oceans) out
#    area_statistics:
#      operator: sum


  prep_timeseries_2d_air:
    custom_order: true
    annual_statistics:
      operator: mean
    area_statistics:
      operator: mean
      fx_variables: [{short_name: areacella, mip: fx, exp: piControl, ensemble: r1i1p1f2, grid: gn, activity: CMIP}]

  prep_total_air:
    custom_order: true
#    area_statistics:
#      operator: sum



diagnostics:
  # --------------------------------------------------
  # Time series diagnostics
  # --------------------------------------------------
  time_series:
    variables:
      area_land:
        short_name: areacella
        preprocessor: prep_total_land
        project: CMIP6
        mip: fx
        exp: piControl
        grid: gn
        start_year: 1850
        end_year: 1850


      area_air:
        short_name: areacella
        preprocessor: prep_total_air
        project: CMIP6
        mip: fx
        exp: piControl
        grid: gn
        start_year: 1850
        end_year: 1850

      area_sea:
        short_name: areacello
        preprocessor: prep_total_sea
        project: CMIP6
        mip: Ofx
        exp: piControl
        grid: gn
        start_year: 1850
        end_year: 1850


      ########################
      # Atmosphere
      timeseries_tas_his:
        short_name: tas
        preprocessor: prep_timeseries_2d_air
        fx_var_preprocess: True
        project: CMIP6
        mip: Amon
        exp: historical
        start_year: 1850
        end_year: 2014
        grid: gn

      timeseries_tas_ssp119:
        short_name: tas
        preprocessor: prep_timeseries_2d_air
        fx_var_preprocess: True
        project: CMIP6
        mip: Amon
        exp: [historical, ssp119]
        start_year: 1990
        end_year: 2100
        grid: gn

      timeseries_tas_ssp126:
        short_name: tas
        preprocessor: prep_timeseries_2d_air
        fx_var_preprocess: True
        project: CMIP6
        mip: Amon
        exp: [historical, ssp126]
        start_year: 1990
        end_year: 2100
        grid: gn

      timeseries_tas_ssp245:
        short_name: tas
        preprocessor: prep_timeseries_2d_air
        fx_var_preprocess: True
        project: CMIP6
        mip: Amon
        exp: [historical, ssp245]
        start_year: 1990
        end_year: 2100
        grid: gn

      timeseries_tas_ssp370:
        short_name: tas
        preprocessor: prep_timeseries_2d_air
        fx_var_preprocess: True
        project: CMIP6
        mip: Amon
        exp: [historical, ssp370]
        start_year: 1990
        end_year: 2100
        grid: gn

      timeseries_tas_ssp585:
        short_name: tas
        preprocessor: prep_timeseries_2d_air
        fx_var_preprocess: True
        project: CMIP6
        mip: Amon
        exp: [historical, ssp585]
        start_year: 1990
        end_year: 2100
        grid: gn


      ########################
      # Ocean
      timeseries_fgco2_hist:
        short_name: fgco2
        preprocessor: prep_timeseries_2d_sea
        fx_var_preprocess: True
        project: CMIP6
        mip: Omon
        exp: historical
        start_year: 1850
        end_year: 2014
        grid: gn
      timeseries_fgco2_ssp119:
        short_name: fgco2
        preprocessor: prep_timeseries_2d_sea
        fx_var_preprocess: True
        project: CMIP6
        mip: Omon
        exp: [historical, ssp119]
        start_year: 1990
        end_year: 2100
        grid: gn

      timeseries_fgco2_ssp126:
        short_name: fgco2
        preprocessor: prep_timeseries_2d_sea
        fx_var_preprocess: True
        project: CMIP6
        mip: Omon
        exp: [historical, ssp126]
        start_year: 1990
        end_year: 2100
        grid: gn
      timeseries_fgco2_ssp245:
        short_name: fgco2
        preprocessor: prep_timeseries_2d_sea
        fx_var_preprocess: True
        project: CMIP6
        mip: Omon
        exp: [historical, ssp245]
        start_year: 1990
        end_year: 2100
        grid: gn
      timeseries_fgco2_ssp370:
        short_name: fgco2
        preprocessor: prep_timeseries_2d_sea
        fx_var_preprocess: True
        project: CMIP6
        mip: Omon
        exp: [historical, ssp370]
        start_year: 1990
        end_year: 2100
        grid: gn
      timeseries_fgco2_ssp585:
        short_name: fgco2
        preprocessor: prep_timeseries_2d_sea
        fx_var_preprocess: True
        project: CMIP6
        mip: Omon
        exp: [historical, ssp585]
        start_year: 1990
        end_year: 2100
        grid: gn

          #


      ########################
      # Land
      timeseries_nbp_hist:
        short_name: nbp
        preprocessor: prep_timeseries_2d_land
        fx_var_preprocess: True
        project: CMIP6
        mip: Lmon
        exp: historical
        start_year: 1850
        end_year: 2014
        grid: gn
      timeseries_nbp_119:
        short_name: nbp
        preprocessor: prep_timeseries_2d_land
        fx_var_preprocess: True
        project: CMIP6
        mip: Lmon
        exp: [historical, ssp119]
        start_year: 1850
        end_year: 2014
        grid: gn
      timeseries_nbp_126:
        short_name: nbp
        preprocessor: prep_timeseries_2d_land
        fx_var_preprocess: True
        project: CMIP6
        mip: Lmon
        exp: [historical, ssp126]
        start_year: 1850
        end_year: 2014
        grid: gn
      timeseries_nbp_245:
        short_name: nbp
        preprocessor: prep_timeseries_2d_land
        fx_var_preprocess: True
        project: CMIP6
        mip: Lmon
        exp: [historical, ssp245]
        start_year: 1850
        end_year: 2014
        grid: gn
      timeseries_nbp_370:
        short_name: nbp
        preprocessor: prep_timeseries_2d_land
        fx_var_preprocess: True
        project: CMIP6
        mip: Lmon
        exp: [historical, ssp370]
        start_year: 1850
        end_year: 2014
        grid: gn
      timeseries_nbp_585:
        short_name: nbp
        preprocessor: prep_timeseries_2d_land
        fx_var_preprocess: True
        project: CMIP6
        mip: Lmon
        exp: [historical, ssp585]
        start_year: 1850
        end_year: 2014
        grid: gn

    scripts:
      diagnostic_timeseries:
        script: ocean/diagnostic_timeseries.py

      diagnostic_gwt_timeseries:
        script: ocean/diagnostic_gwt_timeseries.py
