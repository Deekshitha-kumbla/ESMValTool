# ESMValTool
# globwat.yml
---
documentation:
  description: |
    Recipe pre-processes ERA-Interim and ERA-5 data
    for use in the GlobWat hydrological model.

    GlobWat is a Global Hydrological Model provided by FAO
    http: //www.fao.org/nr/water/aquamaps/
  authors: ['abdollahi_banafsheh','alidoost_sarah']
  projects: ['ewatercycle']
  references: ['acknow_project']

preprocessors:
  general: &general
    mask_landsea:
      mask_out: "sea"
    # regrid:
    #   target_grid: 0.1x0.1 # TODO: change the target to 0.08333*0.08333
    #   lon_offset: true
    #   lat_offset: true
    #   scheme: nearest #area_weighted and linear results in memory issues 

diagnostics:
# TODO: can we use the daily reference evaporation in the model as well?
# """
# Currently, the model reads monthly reference evaporation and then multiplies it by kc and then 
# divide it by the number of days in each month and uses it as daily actual evaporation in the model. 
# We can change the model code to read daily reference evaporation and does the calculation, but we
# did not change the model code for this aim yet. 
# """
  # diagnostic_daily_GlobWat:
  #   description: daily precipitation of ERA5 & ERA-Interim
  #   additional_datasets:
  #     - {dataset: ERA-Interim, project: OBS6, tier: 3, type: reanaly, version: 1}
  #     - {dataset: ERA5, project: OBS6, type: reanaly, version: '1', tier: 3}
  #   variables:
  #     pr: &daily_var
  #       mip: day
  #       start_year: 2004
  #       end_year: 2004
  #       preprocessor: general
  #     tas: *daily_var
  #     psl: *daily_var
  #     rsds: *daily_var
  #     rsdt: *daily_var
  #   scripts:
  #     script:
  #       script: hydrology/globwat_diag.py

  diagnostic_monthly_GlobWat:
      description: monthly precipitation and potential evaporation of ERA5 & ERA-Interim
      additional_datasets:
        - {dataset: ERA-Interim, project: OBS6, tier: 3, type: reanaly, version: 1}
        - {dataset: ERA5, project: native6, type: reanaly, version: '1', tier: 3, start_year: 2004, end_year: 2004}
      variables:
        pr: &var_monthly
          mip: Amon
          start_year: 2004
          end_year: 2004
          preprocessor: general
        # evspsblpot: *var_monthly
        # ERA-Interim does not have pet. Thus, we need tas, psl, rsds, and rsdt to calculate it.
        tas: *var_monthly
        psl: *var_monthly
        rsds: *var_monthly
        rsdt: *var_monthly
      scripts:
        script:
          script: hydrology/globwat_diag.py
