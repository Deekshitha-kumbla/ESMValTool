#ESMValTool
---
documentation:
  description: |
    This recipe prepares and formats the input variables to be
    read by the BSC cyclone tracker, a modified version of the
    GFDL vortex tracker V3.5b by the
    National Oceanic and Atmospheric Administration (NOAA).

  authors:
    - kreussler_philip
    - caron_louis-philippe

  maintainer:
    - loosveldt-tomas_saskia

  references:
    - kreussler2021

  projects:
    - primavera


datasets:
  - {project: CMIP6, mip: 6hrPlevPt, dataset: CNRM-CM6-1, exp: highresSST-present, ensemble: r1i1p1f2, grid: gr, start_year: 2011, end_year: 2011}

preprocessors:
  ppregrid:
    extract_time: &time_period
      start_year: 2011
      start_month: 1
      start_day: 1
      end_year: 2011
      end_month: 7
      end_day: 1
    regrid:
      target_grid: 1x1
      scheme: linear

  ppwind:
    extract_time: *time_period
    extract_levels:
      levels: [85000, 70000, 50000]
      scheme: linear
    regrid:
      target_grid: 1x1
      scheme: linear

  ppta:
    extract_time: *time_period
    extract_levels:
      levels: [50000,45000,40000,35000,30000]
      scheme: linear
    regrid:
      target_grid: 1x1
      scheme: linear

  ppzg:
    extract_time: *time_period
    extract_levels:
      levels: [90000, 85000, 80000, 75000, 70000, 65000, 60000, 55000, 50000,
    45000, 40000, 35000, 30000]
      scheme: linear
    regrid:
      target_grid: 1x1
      scheme: linear


diagnostics:
  tracker:
    variables:
      psl:
        preprocessor: ppregrid
      ua:
        preprocessor: ppwind
      va:
        preprocessor: ppwind
      uas:
        preprocessor: ppregrid
      vas:
        preprocessor: ppregrid
      ta:
        preprocessor: ppta
      zg:
        preprocessor: ppzg
        cmor_name: zg7h
    scripts:
      preproccess:
        westbd: 10
        eastbd: 30
        northbd: 30
        southbd: 10
        type: 'tcgen'
        mslpthresh: 0.01
        mslpthresh2: 101000
        v850thresh: 5
        contint: 100.0
        wcore_depth: 1.0
        verb: 3
        ikeflag: y
        tracker_exe: '/path/to/tracker.exe'
        script: primavera/cyclone_tracker/cyclone_tracker.py
  
