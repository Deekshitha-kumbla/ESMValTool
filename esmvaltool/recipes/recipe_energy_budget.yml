#ESMValTool
---
documentation:
  description: |
    Recipe to compute energy budgets in global, land and ocean domains.
    The path to the Trenberth Diagram template needs to be provided to
    generate the plot. If left empty, the output will be a netCDF file per
    model containing the budget variables.

  authors:
    - vanniere_benoit

  maintainer:
    - loosveldt-tomas_saskia

  projects:
    - primavera

datasets:
  - {dataset: CMCC-CM,  project: CMIP5, mip: Amon, exp: historical,  ensemble: r1i1p1,  start_year: 2000,  end_year: 2002}
  - {dataset: CMCC-CMS,  project: CMIP5, mip: Amon, exp: historical,  ensemble: r1i1p1,  start_year: 2000,  end_year: 2002}
#  - {dataset: HadGEM3-GC31-LM,  project: CMIP6, mip: Amon, exp: highresSST-present,  ensemble: r1i1p1f1, grid: gn,  start_year: 2000,  end_year: 2002}
#  - {dataset: HadGEM3-GC31-HM,  project: CMIP6, mip: Amon, exp: highresSST-present,  ensemble: r1i1p1f1, grid: gn,  start_year: 2000,  end_year: 2002}
#  - {dataset: HadGEM3-GC31-MM,  project: CMIP6, mip: Amon, exp: highresSST-present,  ensemble: r1i1p1f1, grid: gn,  start_year: 2000,  end_year: 2002}

preprocessors:
  global_mean:
    area_statistics:
      operator: mean
    climate_statistics:

  land_mean:
    mask_landsea:
      mask_out: sea
    area_statistics:
      operator: mean
    climate_statistics:

  ocean_mean:
    mask_landsea:
      mask_out: land
    area_statistics:
      operator: mean
    climate_statistics:


diagnostics:
  global_energy_budget:
    description: "Energy budget"
    variables:
      rsdt:
        preprocessor: global_mean
      rsut:
        preprocessor: global_mean
      rsds:
        preprocessor: global_mean
      rsns:
        derive: True
        preprocessor: global_mean
      rlut:
        preprocessor: global_mean
      rlds:
        preprocessor: global_mean
      rlns:
        derive: True
        preprocessor: global_mean
      hfss:
        preprocessor: global_mean
      hfls:
        preprocessor: global_mean
    scripts:
      energy_budget:
        script: primavera/energy_budget.py
        plot_template: plot_templates/energy_budget_template.png

  land_energy_budget:
    description: "Energy budget excluding ocean domain"
    variables:
      rsdt:
        preprocessor: land_mean
      rsut:
        preprocessor: land_mean
      rsds:
        preprocessor: land_mean
      rsns:
        derive: True
        preprocessor: land_mean
      rlut:
        preprocessor: land_mean
      rlds:
        preprocessor: land_mean
      rlns:
        derive: True
        preprocessor: land_mean
      hfss:
        preprocessor: land_mean
      hfls:
        preprocessor: land_mean
    scripts:
      energy_budget_land:
        script: primavera/energy_budget.py
        plot_template: plot_templates/energy_budget_template.png

  ocean_energy_budget:
    description: "Energy budget excluding land domain"
    variables:
      rsdt:
        preprocessor: ocean_mean
      rsut:
        preprocessor: ocean_mean
      rsds:
        preprocessor: ocean_mean
      rsns:
        derive: True
        preprocessor: ocean_mean
      rlut:
        preprocessor: ocean_mean
      rlds:
        preprocessor: ocean_mean
      rlns:
        derive: True
        preprocessor: ocean_mean
      hfss:
        preprocessor: ocean_mean
      hfls:
        preprocessor: ocean_mean
    scripts:
      energy_budget_ocean:
        script: primavera/energy_budget.py
        plot_template:
