# ESMValTool
# recipe_jules_variable_extract.yml
---
documentation:
  description: Extracting mean variables over monthly timescales to feed IMOGEN
  title: Generating Climate Patterns

  authors:
    - munday_gregory

preprocessors:
  global_mean_monthly:
    monthly_statistics:
      operator: mean

    regrid:
      target_grid: {start_longitude: -180, end_longitude: 176.25, step_longitude: 3.75,
                    start_latitude: -55, end_latitude: 82.5, step_latitude: 2.5}
      scheme: linear

  mean_annual:
    annual_statistics:
      operator: mean

monthly_global_settings: &monthly_global_settings
  start_year: 1850
  end_year: 2100
  preprocessor: global_mean_monthly

annual_mean_settings: &annual_mean_settings
  start_year: 1850
  end_year: 2100
  preprocessor: mean_annual

annual_mean_settings_abrupt: &annual_mean_settings_abrupt
  start_year: 1850
  end_year: 1999
  preprocessor: mean_annual

diagnostics:
  monthly_timeseries:
    description: Mean monthly variables

    variables:
      tasmax_585:
        short_name: tasmax
        <<: *monthly_global_settings
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, exp: [historical, ssp585],
             mip: Amon, ensemble: r1i1p1f2, grid: gn}

      tasmin_585:
        short_name: tasmin
        <<: *monthly_global_settings
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, exp: [historical, ssp585],
             mip: Amon, ensemble: r1i1p1f2, grid: gn}

      tas_585:
        short_name: tas
        <<: *monthly_global_settings
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, exp: [historical, ssp585],
             mip: Amon, ensemble: r1i1p1f2, grid: gn}

      hurs_585:
        short_name: hurs
        <<: *monthly_global_settings
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, exp: [historical, ssp585],
             mip: Amon, ensemble: r1i1p1f2, grid: gn}

      huss_585:
        short_name: huss
        <<: *monthly_global_settings
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, exp: [historical, ssp585],
             mip: Amon, ensemble: r1i1p1f2, grid: gn}

      pr_585:
        short_name: pr
        <<: *monthly_global_settings
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, exp: [historical, ssp585],
             mip: Amon, ensemble: r1i1p1f2, grid: gn}

      sfcWind_585:
        short_name: sfcWind
        <<: *monthly_global_settings
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, exp: [historical, ssp585],
             mip: Amon, ensemble: r1i1p1f2, grid: gn}

      ps_585:
        short_name: ps
        <<: *monthly_global_settings
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, exp: [historical, ssp585],
             mip: Amon, ensemble: r1i1p1f2, grid: gn}

      rsds_585:
        short_name: rsds
        <<: *monthly_global_settings
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, exp: [historical, ssp585],
             mip: Amon, ensemble: r1i1p1f2, grid: gn}

      rlds_585:
        short_name: rlds
        <<: *monthly_global_settings
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, exp: [historical, ssp585],
             mip: Amon, ensemble: r1i1p1f2, grid: gn}

    scripts:
      variable_extraction_script:
        script: climate_patterns/variable_extraction.py

  annual_timeseries:
    description: Mean annual TOA fluxes and tas

    variables:
      land_frac:
        short_name: sftlf
        timerange: '1850/2100'
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, mip: fx,
             exp: piControl, ensemble: r1i1p1f2, grid: gn}

      tas_abrupt4x:
        short_name: tas
        <<: *annual_mean_settings_abrupt
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, mip: Amon,
             exp: abrupt-4xCO2, ensemble: r1i1p1f2, grid: gn}

      rtmt_abrupt4x:
        short_name: rtmt
        <<: *annual_mean_settings_abrupt
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, mip: Amon,
             exp: abrupt-4xCO2, ensemble: r1i1p1f2, grid: gn}

      rtmt_585:
        short_name: rtmt
        <<: *annual_mean_settings
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, exp: [historical, ssp585],
             mip: Amon, ensemble: r1i1p1f2, grid: gn}

      tas_585:
        short_name: tas
        <<: *annual_mean_settings
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, exp: [historical, ssp585],
             mip: Amon, ensemble: r1i1p1f2, grid: gn}

      rlut_585:
        short_name: rlut
        <<: *annual_mean_settings
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, exp: [historical, ssp585],
             mip: Amon, ensemble: r1i1p1f2, grid: gn}

      rsut_585:
        short_name: rsut
        <<: *annual_mean_settings
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, exp: [historical, ssp585],
             mip: Amon, ensemble: r1i1p1f2, grid: gn}

      rsdt_585:
        short_name: rsdt
        <<: *annual_mean_settings
        additional_datasets:
          - {dataset: UKESM1-0-LL, project: CMIP6, exp: [historical, ssp585],
             mip: Amon, ensemble: r1i1p1f2, grid: gn}

        # land_frac:
        #   short_name: sftlf
        #   timerange: '1850/2100'
        #   additional_datasets:
        #     - {dataset: MIROC-ESM-CHEM, project: CMIP5, mip: fx,
        #       exp: piControl, ensemble: r1i1p1}

        # rtmt_585:
        #   short_name: rtmt
        #   <<: *annual_mean_settings
        #   additional_datasets:
        #     - {dataset: MIROC-ESM-CHEM, project: CMIP5, exp: [historical, rcp85],
        #       mip: Amon, ensemble: r1i1p1}

        # tas_585:
        #   short_name: tas
        #   <<: *annual_mean_settings
        #   additional_datasets:
        #     - {dataset: MIROC-ESM-CHEM, project: CMIP5, exp: [historical, rcp85],
        #       mip: Amon, ensemble: r1i1p1}

        # rlut_585:
        #   short_name: rlut
        #   <<: *annual_mean_settings
        #   additional_datasets:
        #     - {dataset: MIROC-ESM-CHEM, project: CMIP5, exp: [historical, rcp85],
        #       mip: Amon, ensemble: r1i1p1}

        # rsut_585:
        #   short_name: rsut
        #   <<: *annual_mean_settings
        #   additional_datasets:
        #     - {dataset: MIROC-ESM-CHEM, project: CMIP5, exp: [historical, rcp85],
        #       mip: Amon, ensemble: r1i1p1}

        # rsdt_585:
        #   short_name: rsdt
        #   <<: *annual_mean_settings
        #   additional_datasets:
        #     - {dataset: MIROC-ESM-CHEM, project: CMIP5, exp: [historical, rcp85],
        #       mip: Amon, ensemble: r1i1p1}
    scripts:
      energy_balance_script:
        script: climate_patterns/ebm_parameters.py
